#include "QuadratureGauss2DTri.h"
#include "QuadratureGauss1D.h"
#include "CallStack.h"
#include "Common.h"
#include "RefDomain.h"
#include "Tri.h"

namespace godzilla {

static QPoint2D gauss_pts_0_2d_tri[] = { QPoint2D(-1.0 / 3, -1.0 / 3, 2.0) };

static QPoint2D gauss_pts_1_2d_tri[] = { QPoint2D(-1.0 / 3, -1.0 / 3, 2.0) };

static QPoint2D gauss_pts_2_2d_tri[] = { QPoint2D(-2.0 / 3, -2.0 / 3, 2.0 / 3),
                                         QPoint2D(-2.0 / 3, 1.0 / 3, 2.0 / 3),
                                         QPoint2D(1.0 / 3, -2.0 / 3, 2.0 / 3) };

static QPoint2D gauss_pts_3_2d_tri[] = { QPoint2D(-1.0 / 3, -1.0 / 3, -1.125),
                                         QPoint2D(-0.6, -0.6, 1.041666666666667),
                                         QPoint2D(-0.6, 0.2, 1.041666666666667),
                                         QPoint2D(0.2, -0.6, 1.041666666666667) };

static QPoint2D gauss_pts_4_2d_tri[] = {
    QPoint2D(-0.108103018168070, -0.108103018168070, 0.446763179356022),
    QPoint2D(-0.108103018168070, -0.783793963663860, 0.446763179356022),
    QPoint2D(-0.783793963663860, -0.108103018168070, 0.446763179356022),
    QPoint2D(-0.816847572980458, -0.816847572980458, 0.219903487310644),
    QPoint2D(-0.816847572980458, 0.633695145960918, 0.219903487310644),
    QPoint2D(0.633695145960918, -0.816847572980458, 0.219903487310644)
};

static QPoint2D gauss_pts_5_2d_tri[] = {
    QPoint2D(-1.0 / 3, -1.0 / 3, 0.45),
    QPoint2D(-0.059715871789770, -0.059715871789770, 0.264788305577012),
    QPoint2D(-0.059715871789770, -0.880568256420460, 0.264788305577012),
    QPoint2D(-0.880568256420460, -0.059715871789770, 0.264788305577012),
    QPoint2D(-0.797426985353088, -0.797426985353088, 0.251878361089654),
    QPoint2D(-0.797426985353088, 0.594853970706174, 0.251878361089654),
    QPoint2D(0.594853970706174, -0.797426985353088, 0.251878361089654)
};

static QPoint2D gauss_pts_6_2d_tri[] = {
    QPoint2D(-0.501426509658180, -0.501426509658180, 0.233572551452758),
    QPoint2D(-0.501426509658180, 0.002853019316358, 0.233572551452758),
    QPoint2D(0.002853019316358, -0.501426509658180, 0.233572551452758),
    QPoint2D(-0.873821971016996, -0.873821971016996, 0.101689812740414),
    QPoint2D(-0.873821971016996, 0.747643942033992, 0.101689812740414),
    QPoint2D(0.747643942033992, -0.873821971016996, 0.101689812740414),
    QPoint2D(-0.379295097932432, 0.273004998242798, 0.165702151236748),
    QPoint2D(0.273004998242798, -0.893709900310366, 0.165702151236748),
    QPoint2D(-0.893709900310366, -0.379295097932432, 0.165702151236748),
    QPoint2D(-0.379295097932432, -0.893709900310366, 0.165702151236748),
    QPoint2D(0.273004998242798, -0.379295097932432, 0.165702151236748),
    QPoint2D(-0.893709900310366, 0.273004998242798, 0.165702151236748)
};

static QPoint2D gauss_pts_7_2d_tri[] = {
    QPoint2D(-1.0 / 3, -1.0 / 3, -0.299140088935364),
    QPoint2D(-0.479308067841920, -0.479308067841920, 0.351230514866416),
    QPoint2D(-0.479308067841920, -0.041383864316160, 0.351230514866416),
    QPoint2D(-0.041383864316160, -0.479308067841920, 0.351230514866416),
    QPoint2D(-0.869739794195568, -0.869739794195568, 0.106694471217676),
    QPoint2D(-0.869739794195568, 0.739479588391136, 0.106694471217676),
    QPoint2D(0.739479588391136, -0.869739794195568, 0.106694471217676),
    QPoint2D(-0.374269007990252, 0.276888377139620, 0.154227521780514),
    QPoint2D(0.276888377139620, -0.902619369149368, 0.154227521780514),
    QPoint2D(-0.902619369149368, -0.374269007990252, 0.154227521780514),
    QPoint2D(-0.374269007990252, -0.902619369149368, 0.154227521780514),
    QPoint2D(0.276888377139620, -0.374269007990252, 0.154227521780514),
    QPoint2D(-0.902619369149368, 0.276888377139620, 0.154227521780514)
};

static QPoint2D gauss_pts_8_2d_tri[] = {
    QPoint2D(-1.0 / 3, -1.0 / 3, 0.288631215355574),
    QPoint2D(-0.081414823414554, -0.081414823414554, 0.190183268534570),
    QPoint2D(-0.081414823414554, -0.837170353170892, 0.190183268534570),
    QPoint2D(-0.837170353170892, -0.081414823414554, 0.190183268534570),
    QPoint2D(-0.658861384496480, -0.658861384496480, 0.206434741069436),
    QPoint2D(-0.658861384496480, 0.317722768992960, 0.206434741069436),
    QPoint2D(0.317722768992960, -0.658861384496480, 0.206434741069436),
    QPoint2D(-0.898905543365938, -0.898905543365938, 0.064916995246396),
    QPoint2D(-0.898905543365938, 0.797811086731876, 0.064916995246395),
    QPoint2D(0.797811086731876, -0.898905543365938, 0.064916995246396),
    QPoint2D(-0.473774340730724, 0.456984785910808, 0.054460628348870),
    QPoint2D(0.456984785910808, -0.983210445180084, 0.054460628348870),
    QPoint2D(-0.983210445180084, -0.473774340730724, 0.054460628348870),
    QPoint2D(-0.473774340730724, -0.983210445180084, 0.054460628348870),
    QPoint2D(0.456984785910808, -0.473774340730724, 0.054460628348870),
    QPoint2D(-0.983210445180084, 0.456984785910808, 0.054460628348870)
};

static QPoint2D gauss_pts_9_2d_tri[] = {
    QPoint2D(-1.0 / 3, -1.0 / 3, 0.194271592565598),
    QPoint2D(-0.020634961602524, -0.020634961602524, 0.062669400454278),
    QPoint2D(-0.020634961602524, -0.958730076794950, 0.062669400454278),
    QPoint2D(-0.958730076794950, -0.020634961602524, 0.062669400454278),
    QPoint2D(-0.125820817014126, -0.125820817014126, 0.155655082009548),
    QPoint2D(-0.125820817014126, -0.748358365971746, 0.155655082009548),
    QPoint2D(-0.748358365971746, -0.125820817014126, 0.155655082009548),
    QPoint2D(-0.623592928761934, -0.623592928761934, 0.159295477854420),
    QPoint2D(-0.623592928761934, 0.247185857523870, 0.159295477854420),
    QPoint2D(0.247185857523870, -0.623592928761934, 0.159295477854420),
    QPoint2D(-0.910540973211094, -0.910540973211094, 0.051155351317396),
    QPoint2D(-0.910540973211094, 0.821081946422190, 0.051155351317396),
    QPoint2D(0.821081946422190, -0.910540973211094, 0.051155351317396),
    QPoint2D(-0.556074021678468, 0.482397197568996, 0.086567078754578),
    QPoint2D(0.482397197568996, -0.926323175890528, 0.086567078754578),
    QPoint2D(-0.926323175890528, -0.556074021678468, 0.086567078754578),
    QPoint2D(-0.556074021678468, -0.926323175890528, 0.086567078754578),
    QPoint2D(0.482397197568996, -0.556074021678468, 0.086567078754578),
    QPoint2D(-0.926323175890528, 0.482397197568996, 0.086567078754578)
};

static QPoint2D gauss_pts_10_2d_tri[] = {
    QPoint2D(-1.0 / 3, -1.0 / 3, 0.181635980765508),
    QPoint2D(-0.028844733232686, -0.028844733232686, 0.073451915512934),
    QPoint2D(-0.028844733232686, -0.942310533534630, 0.073451915512934),
    QPoint2D(-0.942310533534630, -0.028844733232686, 0.073451915512934),
    QPoint2D(-0.781036849029926, -0.781036849029926, 0.090642118871056),
    QPoint2D(-0.781036849029926, 0.562073698059852, 0.090642118871056),
    QPoint2D(0.562073698059852, -0.781036849029926, 0.090642118871056),
    QPoint2D(-0.384120322471758, 0.100705883641998, 0.145515833690840),
    QPoint2D(0.100705883641998, -0.716585561170240, 0.145515833690840),
    QPoint2D(-0.716585561170240, -0.384120322471758, 0.145515833690840),
    QPoint2D(-0.384120322471758, -0.716585561170240, 0.145515833690840),
    QPoint2D(0.100705883641998, -0.384120322471758, 0.145515833690840),
    QPoint2D(-0.716585561170240, 0.100705883641998, 0.145515833690840),
    QPoint2D(-0.506654878720194, 0.456647809194822, 0.056654485062114),
    QPoint2D(0.456647809194822, -0.949992930474628, 0.056654485062114),
    QPoint2D(-0.949992930474628, -0.506654878720194, 0.056654485062114),
    QPoint2D(-0.506654878720194, -0.949992930474628, 0.056654485062114),
    QPoint2D(0.456647809194822, -0.506654878720194, 0.056654485062114),
    QPoint2D(-0.949992930474628, 0.456647809194822, 0.056654485062114),
    QPoint2D(-0.866393497975600, 0.847311867175000, 0.018843333927466),
    QPoint2D(0.847311867175000, -0.980918369199402, 0.018843333927466),
    QPoint2D(-0.980918369199402, -0.866393497975600, 0.018843333927466),
    QPoint2D(-0.866393497975600, -0.980918369199402, 0.018843333927466),
    QPoint2D(0.847311867175000, -0.866393497975600, 0.018843333927466),
    QPoint2D(-0.980918369199402, 0.847311867175000, 0.018843333927466)
};

static QPoint2D gauss_pts_11_2d_tri[] = {
    QPoint2D(0.069222096541516, 0.069222096541516, 0.001854012657922),
    QPoint2D(0.069222096541516, -1.138444193083034, 0.001854012657922),
    QPoint2D(-1.138444193083034, 0.069222096541516, 0.001854012657922),
    QPoint2D(-0.202061394068290, -0.202061394068290, 0.154299069829626),
    QPoint2D(-0.202061394068290, -0.595877211863420, 0.154299069829626),
    QPoint2D(-0.595877211863420, -0.202061394068290, 0.154299069829626),
    QPoint2D(-0.593380199137436, -0.593380199137436, 0.118645954761548),
    QPoint2D(-0.593380199137436, 0.186760398274870, 0.118645954761548),
    QPoint2D(0.186760398274870, -0.593380199137436, 0.118645954761548),
    QPoint2D(-0.761298175434838, -0.761298175434838, 0.072369081006836),
    QPoint2D(-0.761298175434838, 0.522596350869674, 0.072369081006836),
    QPoint2D(0.522596350869674, -0.761298175434838, 0.072369081006836),
    QPoint2D(-0.935270103777448, -0.935270103777448, 0.027319462005356),
    QPoint2D(-0.935270103777448, 0.870540207554896, 0.027319462005356),
    QPoint2D(0.870540207554896, -0.935270103777448, 0.027319462005356),
    QPoint2D(-0.286758703477414, 0.186402426856426, 0.104674223924408),
    QPoint2D(0.186402426856426, -0.899643723379010, 0.104674223924408),
    QPoint2D(-0.899643723379010, -0.286758703477414, 0.104674223924408),
    QPoint2D(-0.286758703477414, -0.899643723379010, 0.104674223924408),
    QPoint2D(0.186402426856426, -0.286758703477414, 0.104674223924408),
    QPoint2D(-0.899643723379010, 0.186402426856426, 0.104674223924408),
    QPoint2D(-0.657022039391916, 0.614978006319584, 0.041415319278282),
    QPoint2D(0.614978006319584, -0.957955966927668, 0.041415319278282),
    QPoint2D(-0.957955966927668, -0.657022039391916, 0.041415319278282),
    QPoint2D(-0.657022039391916, -0.957955966927668, 0.041415319278282),
    QPoint2D(0.614978006319584, -0.657022039391916, 0.041415319278282),
    QPoint2D(-0.957955966927668, 0.614978006319584, 0.041415319278282)
};

static QPoint2D gauss_pts_12_2d_tri[] = {
    QPoint2D(-0.023565220452390, -0.023565220452390, 0.051462132880910),
    QPoint2D(-0.023565220452390, -0.952869559095220, 0.051462132880910),
    QPoint2D(-0.952869559095220, -0.023565220452390, 0.051462132880910),
    QPoint2D(-0.120551215411080, -0.120551215411080, 0.087385089076076),
    QPoint2D(-0.120551215411080, -0.758897569177842, 0.087385089076076),
    QPoint2D(-0.758897569177842, -0.120551215411080, 0.087385089076076),
    QPoint2D(-0.457579229975768, -0.457579229975768, 0.125716448435770),
    QPoint2D(-0.457579229975768, -0.084841540048464, 0.125716448435770),
    QPoint2D(-0.084841540048464, -0.457579229975768, 0.125716448435770),
    QPoint2D(-0.744847708916828, -0.744847708916828, 0.069592225861418),
    QPoint2D(-0.744847708916828, 0.489695417833656, 0.069592225861418),
    QPoint2D(0.489695417833656, -0.744847708916828, 0.069592225861418),
    QPoint2D(-0.957365299093580, -0.957365299093580, 0.012332522103118),
    QPoint2D(-0.957365299093580, 0.914730598187158, 0.012332522103118),
    QPoint2D(0.914730598187158, -0.957365299093580, 0.012332522103118),
    QPoint2D(-0.448573460628972, 0.217886471559576, 0.080743115532762),
    QPoint2D(0.217886471559576, -0.769313010930604, 0.080743115532762),
    QPoint2D(-0.769313010930604, -0.448573460628972, 0.080743115532762),
    QPoint2D(-0.448573460628972, -0.769313010930604, 0.080743115532762),
    QPoint2D(0.217886471559576, -0.448573460628972, 0.080743115532762),
    QPoint2D(-0.769313010930604, 0.217886471559576, 0.080743115532762),
    QPoint2D(-0.437348838020120, 0.391672173575606, 0.044713546404606),
    QPoint2D(0.391672173575606, -0.954323335555486, 0.044713546404606),
    QPoint2D(-0.954323335555486, -0.437348838020120, 0.044713546404606),
    QPoint2D(-0.437348838020120, -0.954323335555486, 0.044713546404606),
    QPoint2D(0.391672173575606, -0.437348838020120, 0.044713546404606),
    QPoint2D(-0.954323335555486, 0.391672173575606, 0.044713546404606),
    QPoint2D(-0.767496168184806, 0.716028067088146, 0.034632462217318),
    QPoint2D(0.716028067088146, -0.948531898903340, 0.034632462217318),
    QPoint2D(-0.948531898903340, -0.767496168184806, 0.034632462217318),
    QPoint2D(-0.767496168184806, -0.948531898903340, 0.034632462217318),
    QPoint2D(0.716028067088146, -0.767496168184806, 0.034632462217318),
    QPoint2D(-0.948531898903340, 0.716028067088146, 0.034632462217318)
};

static QPoint2D gauss_pts_13_2d_tri[] = {
    QPoint2D(-0.333333333333333, -0.333333333333333, 0.105041846801604),
    QPoint2D(-0.009903630120590, -0.009903630120590, 0.022560290418660),
    QPoint2D(-0.009903630120590, -0.980192739758818, 0.022560290418660),
    QPoint2D(-0.980192739758818, -0.009903630120590, 0.022560290418660),
    QPoint2D(-0.062566729780852, -0.062566729780852, 0.062847036724908),
    QPoint2D(-0.062566729780852, -0.874866540438296, 0.062847036724908),
    QPoint2D(-0.874866540438296, -0.062566729780852, 0.062847036724908),
    QPoint2D(-0.170957326397446, -0.170957326397446, 0.094145005008388),
    QPoint2D(-0.170957326397446, -0.658085347205106, 0.094145005008388),
    QPoint2D(-0.658085347205106, -0.170957326397446, 0.094145005008388),
    QPoint2D(-0.541200855914338, -0.541200855914338, 0.094727173072710),
    QPoint2D(-0.541200855914338, 0.082401711828674, 0.094727173072710),
    QPoint2D(0.082401711828674, -0.541200855914338, 0.094727173072710),
    QPoint2D(-0.771151009607340, -0.771151009607340, 0.062335058091588),
    QPoint2D(-0.771151009607340, 0.542302019214680, 0.062335058091588),
    QPoint2D(0.542302019214680, -0.771151009607340, 0.062335058091588),
    QPoint2D(-0.950377217273082, -0.950377217273082, 0.015951542930148),
    QPoint2D(-0.950377217273082, 0.900754434546164, 0.015951542930148),
    QPoint2D(0.900754434546164, -0.950377217273082, 0.015951542930148),
    QPoint2D(-0.462410005882478, 0.272702349123320, 0.073696805457464),
    QPoint2D(0.272702349123320, -0.810292343240842, 0.073696805457464),
    QPoint2D(-0.810292343240842, -0.462410005882478, 0.073696805457464),
    QPoint2D(-0.462410005882478, -0.810292343240842, 0.073696805457464),
    QPoint2D(0.272702349123320, -0.462410005882478, 0.073696805457464),
    QPoint2D(-0.810292343240842, 0.272702349123320, 0.073696805457464),
    QPoint2D(-0.416539866531424, 0.380338319973810, 0.034802926607644),
    QPoint2D(0.380338319973810, -0.963798453442386, 0.034802926607644),
    QPoint2D(-0.963798453442386, -0.416539866531424, 0.034802926607644),
    QPoint2D(-0.416539866531424, -0.963798453442386, 0.034802926607644),
    QPoint2D(0.380338319973810, -0.416539866531424, 0.034802926607644),
    QPoint2D(-0.963798453442386, 0.380338319973810, 0.034802926607644),
    QPoint2D(-0.747285229016662, 0.702819075668482, 0.031043573678090),
    QPoint2D(0.702819075668482, -0.955533846651820, 0.031043573678090),
    QPoint2D(-0.955533846651820, -0.747285229016662, 0.031043573678090),
    QPoint2D(-0.747285229016662, -0.955533846651820, 0.031043573678090),
    QPoint2D(0.702819075668482, -0.747285229016662, 0.031043573678090),
    QPoint2D(-0.955533846651820, 0.702819075668482, 0.031043573678090)
};

static QPoint2D gauss_pts_14_2d_tri[] = {
    QPoint2D(-0.022072179275642, -0.022072179275642, 0.043767162738858),
    QPoint2D(-0.022072179275642, -0.955855641448714, 0.043767162738858),
    QPoint2D(-0.955855641448714, -0.022072179275642, 0.043767162738858),
    QPoint2D(-0.164710561319092, -0.164710561319092, 0.065576707088250),
    QPoint2D(-0.164710561319092, -0.670578877361816, 0.065576707088250),
    QPoint2D(-0.670578877361816, -0.164710561319092, 0.065576707088250),
    QPoint2D(-0.453044943382322, -0.453044943382322, 0.103548209014584),
    QPoint2D(-0.453044943382322, -0.093910113235354, 0.103548209014584),
    QPoint2D(-0.093910113235354, -0.453044943382322, 0.103548209014584),
    QPoint2D(-0.645588935174914, -0.645588935174914, 0.084325177473986),
    QPoint2D(-0.645588935174914, 0.291177870349826, 0.084325177473986),
    QPoint2D(0.291177870349826, -0.645588935174914, 0.084325177473986),
    QPoint2D(-0.876400233818254, -0.876400233818254, 0.028867399339554),
    QPoint2D(-0.876400233818254, 0.752800467636510, 0.028867399339554),
    QPoint2D(0.752800467636510, -0.876400233818254, 0.028867399339554),
    QPoint2D(-0.961218077502598, -0.961218077502598, 0.009846807204800),
    QPoint2D(-0.961218077502598, 0.922436155005196, 0.009846807204800),
    QPoint2D(0.922436155005196, -0.961218077502598, 0.009846807204800),
    QPoint2D(-0.655466624357288, 0.541217109549992, 0.049331506425128),
    QPoint2D(0.541217109549992, -0.885750485192704, 0.049331506425128),
    QPoint2D(-0.885750485192704, -0.655466624357288, 0.049331506425128),
    QPoint2D(-0.655466624357288, -0.885750485192704, 0.049331506425128),
    QPoint2D(0.541217109549992, -0.655466624357288, 0.049331506425128),
    QPoint2D(-0.885750485192704, 0.541217109549992, 0.049331506425128),
    QPoint2D(-0.326277080407310, 0.140444581693366, 0.077143021574122),
    QPoint2D(0.140444581693366, -0.814167501286056, 0.077143021574122),
    QPoint2D(-0.814167501286056, -0.326277080407310, 0.077143021574122),
    QPoint2D(-0.326277080407310, -0.814167501286056, 0.077143021574122),
    QPoint2D(0.140444581693366, -0.326277080407310, 0.077143021574122),
    QPoint2D(-0.814167501286056, 0.140444581693366, 0.077143021574122),
    QPoint2D(-0.403254235727484, 0.373960335616176, 0.028872616227068),
    QPoint2D(0.373960335616176, -0.970706099888692, 0.028872616227068),
    QPoint2D(-0.970706099888692, -0.403254235727484, 0.028872616227068),
    QPoint2D(-0.403254235727484, -0.970706099888692, 0.028872616227068),
    QPoint2D(0.373960335616176, -0.403254235727484, 0.028872616227068),
    QPoint2D(-0.970706099888692, 0.373960335616176, 0.028872616227068),
    QPoint2D(-0.762051004606086, 0.759514342740342, 0.010020457677002),
    QPoint2D(0.759514342740342, -0.997463338134256, 0.010020457677002),
    QPoint2D(-0.997463338134256, -0.762051004606086, 0.010020457677002),
    QPoint2D(-0.762051004606086, -0.997463338134256, 0.010020457677002),
    QPoint2D(0.759514342740342, -0.762051004606086, 0.010020457677002),
    QPoint2D(-0.997463338134256, 0.759514342740342, 0.010020457677002)
};

static QPoint2D gauss_pts_15_2d_tri[] = {
    QPoint2D(0.013945833716486, 0.013945833716486, 0.003833751285698),
    QPoint2D(0.013945833716486, -1.027891667432972, 0.003833751285698),
    QPoint2D(-1.027891667432972, 0.013945833716486, 0.003833751285698),
    QPoint2D(-0.137187291433954, -0.137187291433954, 0.088498054542290),
    QPoint2D(-0.137187291433954, -0.725625417132090, 0.088498054542290),
    QPoint2D(-0.725625417132090, -0.137187291433954, 0.088498054542290),
    QPoint2D(-0.444612710305712, -0.444612710305712, 0.102373097437704),
    QPoint2D(-0.444612710305712, -0.110774579388578, 0.102373097437704),
    QPoint2D(-0.110774579388578, -0.444612710305712, 0.102373097437704),
    QPoint2D(-0.747070217917492, -0.747070217917492, 0.047375471741376),
    QPoint2D(-0.747070217917492, 0.494140435834984, 0.047375471741376),
    QPoint2D(0.494140435834984, -0.747070217917492, 0.047375471741376),
    QPoint2D(-0.858383228050628, -0.858383228050628, 0.026579551380042),
    QPoint2D(-0.858383228050628, 0.716766456101256, 0.026579551380042),
    QPoint2D(0.716766456101256, -0.858383228050628, 0.026579551380042),
    QPoint2D(-0.962069659517854, -0.962069659517854, 0.009497833216384),
    QPoint2D(-0.962069659517854, 0.924139319035706, 0.009497833216384),
    QPoint2D(0.924139319035706, -0.962069659517854, 0.009497833216384),
    QPoint2D(-0.477377257719826, 0.209908933786582, 0.077100145199186),
    QPoint2D(0.209908933786582, -0.732531676066758, 0.077100145199186),
    QPoint2D(-0.732531676066758, -0.477377257719826, 0.077100145199186),
    QPoint2D(-0.477377257719826, -0.732531676066758, 0.077100145199186),
    QPoint2D(0.209908933786582, -0.477377257719826, 0.077100145199186),
    QPoint2D(-0.732531676066758, 0.209908933786582, 0.077100145199186),
    QPoint2D(-0.223906465819462, 0.151173111025628, 0.054431628641248),
    QPoint2D(0.151173111025628, -0.927266645206166, 0.054431628641248),
    QPoint2D(-0.927266645206166, -0.223906465819462, 0.054431628641248),
    QPoint2D(-0.223906465819462, -0.927266645206166, 0.054431628641248),
    QPoint2D(0.151173111025628, -0.223906465819462, 0.054431628641248),
    QPoint2D(-0.927266645206166, 0.151173111025628, 0.054431628641248),
    QPoint2D(-0.428575559900168, 0.448925326153310, 0.004364154733594),
    QPoint2D(0.448925326153310, -1.020349766253142, 0.004364154733594),
    QPoint2D(-1.020349766253142, -0.428575559900168, 0.004364154733594),
    QPoint2D(-0.428575559900168, -1.020349766253142, 0.004364154733594),
    QPoint2D(0.448925326153310, -0.428575559900168, 0.004364154733594),
    QPoint2D(-1.020349766253142, 0.448925326153310, 0.004364154733594),
    QPoint2D(-0.568800671855432, 0.495112932103676, 0.043010639695462),
    QPoint2D(0.495112932103676, -0.926312260248244, 0.043010639695462),
    QPoint2D(-0.926312260248244, -0.568800671855432, 0.043010639695462),
    QPoint2D(-0.568800671855432, -0.926312260248244, 0.043010639695462),
    QPoint2D(0.495112932103676, -0.568800671855432, 0.043010639695462),
    QPoint2D(-0.926312260248244, 0.495112932103676, 0.043010639695462),
    QPoint2D(-0.792848766847228, 0.767929148184832, 0.015347885262098),
    QPoint2D(0.767929148184832, -0.975080381337602, 0.015347885262098),
    QPoint2D(-0.975080381337602, -0.792848766847228, 0.015347885262098),
    QPoint2D(-0.792848766847228, -0.975080381337602, 0.015347885262098),
    QPoint2D(0.767929148184832, -0.792848766847228, 0.015347885262098),
    QPoint2D(-0.975080381337602, 0.767929148184832, 0.015347885262098)
};

static QPoint2D gauss_pts_16_2d_tri[] = {
    QPoint2D(-0.333333333333333, -0.333333333333333, 0.093751394855284),
    QPoint2D(-0.005238916103124, -0.005238916103124, 0.012811757157170),
    QPoint2D(-0.005238916103124, -0.989522167793754, 0.012811757157170),
    QPoint2D(-0.989522167793754, -0.005238916103124, 0.012811757157170),
    QPoint2D(-0.173061122901296, -0.173061122901296, 0.083420593478774),
    QPoint2D(-0.173061122901296, -0.653877754197410, 0.083420593478774),
    QPoint2D(-0.653877754197410, -0.173061122901296, 0.083420593478774),
    QPoint2D(-0.059082801866018, -0.059082801866018, 0.053782968500128),
    QPoint2D(-0.059082801866018, -0.881834396267966, 0.053782968500128),
    QPoint2D(-0.881834396267966, -0.059082801866018, 0.053782968500128),
    QPoint2D(-0.518892500060958, -0.518892500060958, 0.084265045523300),
    QPoint2D(-0.518892500060958, 0.037785000121916, 0.084265045523300),
    QPoint2D(0.037785000121916, -0.518892500060958, 0.084265045523300),
    QPoint2D(-0.704068411554854, -0.704068411554854, 0.060000533685546),
    QPoint2D(-0.704068411554854, 0.408136823109708, 0.060000533685546),
    QPoint2D(0.408136823109708, -0.704068411554854, 0.060000533685546),
    QPoint2D(-0.849069624685052, -0.849069624685052, 0.028400197850048),
    QPoint2D(-0.849069624685052, 0.698139249370104, 0.028400197850048),
    QPoint2D(0.698139249370104, -0.849069624685052, 0.028400197850048),
    QPoint2D(-0.966807194753950, -0.966807194753950, 0.007164924702546),
    QPoint2D(-0.966807194753950, 0.933614389507900, 0.007164924702546),
    QPoint2D(0.933614389507900, -0.966807194753950, 0.007164924702546),
    QPoint2D(-0.406888806840226, 0.199737422349722, 0.065546294921254),
    QPoint2D(0.199737422349722, -0.792848615509496, 0.065546294921254),
    QPoint2D(-0.792848615509496, -0.406888806840226, 0.065546294921254),
    QPoint2D(-0.406888806840226, -0.792848615509496, 0.065546294921254),
    QPoint2D(0.199737422349722, -0.406888806840226, 0.065546294921254),
    QPoint2D(-0.792848615509496, 0.199737422349722, 0.065546294921254),
    QPoint2D(-0.324553873193842, 0.284387049883010, 0.030596612496882),
    QPoint2D(0.284387049883010, -0.959833176689168, 0.030596612496882),
    QPoint2D(-0.959833176689168, -0.324553873193842, 0.030596612496882),
    QPoint2D(-0.324553873193842, -0.959833176689168, 0.030596612496882),
    QPoint2D(0.284387049883010, -0.324553873193842, 0.030596612496882),
    QPoint2D(-0.959833176689168, 0.284387049883010, 0.030596612496882),
    QPoint2D(-0.590503436714376, 0.599185441942654, 0.004772488385678),
    QPoint2D(0.599185441942654, -1.008682005228278, 0.004772488385678),
    QPoint2D(-1.008682005228278, -0.590503436714376, 0.004772488385678),
    QPoint2D(-0.590503436714376, -1.008682005228278, 0.004772488385678),
    QPoint2D(0.599185441942654, -0.590503436714376, 0.004772488385678),
    QPoint2D(-1.008682005228278, 0.599185441942654, 0.004772488385678),
    QPoint2D(-0.621283015738754, 0.537399442802736, 0.038169585511798),
    QPoint2D(0.537399442802736, -0.916116427063980, 0.038169585511798),
    QPoint2D(-0.916116427063980, -0.621283015738754, 0.038169585511798),
    QPoint2D(-0.621283015738754, -0.916116427063980, 0.038169585511798),
    QPoint2D(0.537399442802736, -0.621283015738754, 0.038169585511798),
    QPoint2D(-0.916116427063980, 0.537399442802736, 0.038169585511798),
    QPoint2D(-0.829432768634686, 0.800798128173322, 0.013700109093084),
    QPoint2D(0.800798128173322, -0.971365359538638, 0.013700109093084),
    QPoint2D(-0.971365359538638, -0.829432768634686, 0.013700109093084),
    QPoint2D(-0.829432768634686, -0.971365359538638, 0.013700109093084),
    QPoint2D(0.800798128173322, -0.829432768634686, 0.013700109093084),
    QPoint2D(-0.971365359538638, 0.800798128173322, 0.013700109093084)
};

static QPoint2D gauss_pts_17_2d_tri[] = {
    QPoint2D(-0.333333333333333, -0.333333333333333, 0.066874398581606),
    QPoint2D(-0.005658918886452, -0.005658918886452, 0.010186830881014),
    QPoint2D(-0.005658918886452, -0.988682162227096, 0.010186830881014),
    QPoint2D(-0.988682162227096, -0.005658918886452, 0.010186830881014),
    QPoint2D(-0.035647354750750, -0.035647354750750, 0.029341729055276),
    QPoint2D(-0.035647354750750, -0.928705290498498, 0.029341729055276),
    QPoint2D(-0.928705290498498, -0.035647354750750, 0.029341729055276),
    QPoint2D(-0.099520061958436, -0.099520061958436, 0.048701756707344),
    QPoint2D(-0.099520061958436, -0.800959876083126, 0.048701756707344),
    QPoint2D(-0.800959876083126, -0.099520061958436, 0.048701756707344),
    QPoint2D(-0.199467521245206, -0.199467521245206, 0.062215101737938),
    QPoint2D(-0.199467521245206, -0.601064957509588, 0.062215101737938),
    QPoint2D(-0.601064957509588, -0.199467521245206, 0.062215101737938),
    QPoint2D(-0.495717464058094, -0.495717464058094, 0.062514222437240),
    QPoint2D(-0.495717464058094, -0.008565071883810, 0.062514222437240),
    QPoint2D(-0.008565071883810, -0.495717464058094, 0.062514222437240),
    QPoint2D(-0.675905990683078, -0.675905990683078, 0.049631308679330),
    QPoint2D(-0.675905990683078, 0.351811981366154, 0.049631308679330),
    QPoint2D(0.351811981366154, -0.675905990683078, 0.049631308679330),
    QPoint2D(-0.848248235478508, -0.848248235478508, 0.028112146141114),
    QPoint2D(-0.848248235478508, 0.696496470957016, 0.028112146141114),
    QPoint2D(0.696496470957016, -0.848248235478508, 0.028112146141114),
    QPoint2D(-0.968690546064356, -0.968690546064356, 0.006389352347558),
    QPoint2D(-0.968690546064356, 0.937381092128712, 0.006389352347558),
    QPoint2D(0.937381092128712, -0.968690546064356, 0.006389352347558),
    QPoint2D(-0.331360265272684, 0.310986407618846, 0.016239310637986),
    QPoint2D(0.310986407618846, -0.979626142346162, 0.016239310637986),
    QPoint2D(-0.979626142346162, -0.331360265272684, 0.016239310637986),
    QPoint2D(-0.331360265272684, -0.979626142346162, 0.016239310637986),
    QPoint2D(0.310986407618846, -0.331360265272684, 0.016239310637986),
    QPoint2D(-0.979626142346162, 0.310986407618846, 0.016239310637986),
    QPoint2D(-0.415556924406112, 0.144675181064040, 0.053611484566326),
    QPoint2D(0.144675181064040, -0.729118256657928, 0.053611484566326),
    QPoint2D(-0.729118256657928, -0.415556924406112, 0.053611484566326),
    QPoint2D(-0.415556924406112, -0.729118256657928, 0.053611484566326),
    QPoint2D(0.144675181064040, -0.415556924406112, 0.053611484566326),
    QPoint2D(-0.729118256657928, 0.144675181064040, 0.053611484566326),
    QPoint2D(-0.360850229153620, 0.252002380572456, 0.036919986421644),
    QPoint2D(0.252002380572456, -0.891152151418834, 0.036919986421644),
    QPoint2D(-0.891152151418834, -0.360850229153620, 0.036919986421644),
    QPoint2D(-0.360850229153620, -0.891152151418834, 0.036919986421644),
    QPoint2D(0.252002380572456, -0.360850229153620, 0.036919986421644),
    QPoint2D(-0.891152151418834, 0.252002380572456, 0.036919986421644),
    QPoint2D(-0.618591551615416, 0.592854429948142, 0.016953737068656),
    QPoint2D(0.592854429948142, -0.974262878332726, 0.016953737068656),
    QPoint2D(-0.974262878332726, -0.618591551615416, 0.016953737068656),
    QPoint2D(-0.618591551615416, -0.974262878332726, 0.016953737068656),
    QPoint2D(0.592854429948142, -0.618591551615416, 0.016953737068656),
    QPoint2D(-0.974262878332726, 0.592854429948142, 0.016953737068656),
    QPoint2D(-0.639033576702508, 0.504702011875458, 0.036585593540050),
    QPoint2D(0.504702011875458, -0.865668435172952, 0.036585593540050),
    QPoint2D(-0.865668435172952, -0.639033576702508, 0.036585593540050),
    QPoint2D(-0.639033576702508, -0.865668435172952, 0.036585593540050),
    QPoint2D(0.504702011875458, -0.639033576702508, 0.036585593540050),
    QPoint2D(-0.865668435172952, 0.504702011875458, 0.036585593540050),
    QPoint2D(-0.838577372640872, 0.809251008191216, 0.013331264008330),
    QPoint2D(0.809251008191216, -0.970673635550344, 0.013331264008330),
    QPoint2D(-0.970673635550344, -0.838577372640872, 0.013331264008330),
    QPoint2D(-0.838577372640872, -0.970673635550344, 0.013331264008330),
    QPoint2D(0.809251008191216, -0.838577372640872, 0.013331264008330),
    QPoint2D(-0.970673635550344, 0.809251008191216, 0.013331264008330)
};

static QPoint2D gauss_pts_18_2d_tri[] = {
    QPoint2D(-0.333333333333333, -0.333333333333333, 0.061619879875294),
    QPoint2D(-0.013310382738158, -0.013310382738158, 0.018144873358808),
    QPoint2D(-0.013310382738158, -0.973379234523686, 0.018144873358808),
    QPoint2D(-0.973379234523686, -0.013310382738158, 0.018144873358808),
    QPoint2D(-0.061578811516086, -0.061578811516086, 0.037522633879188),
    QPoint2D(-0.061578811516086, -0.876842376967828, 0.037522633879188),
    QPoint2D(-0.876842376967828, -0.061578811516086, 0.037522633879188),
    QPoint2D(-0.127437208225988, -0.127437208225988, 0.038882195970954),
    QPoint2D(-0.127437208225988, -0.745125583548022, 0.038882195970954),
    QPoint2D(-0.745125583548022, -0.127437208225988, 0.038882195970954),
    QPoint2D(-0.210307658653168, -0.210307658653168, 0.055507897221620),
    QPoint2D(-0.210307658653168, -0.579384682693664, 0.055507897221620),
    QPoint2D(-0.579384682693664, -0.210307658653168, 0.055507897221620),
    QPoint2D(-0.500410862393686, -0.500410862393686, 0.064512450702914),
    QPoint2D(-0.500410862393686, 0.000821724787372, 0.064512450702914),
    QPoint2D(0.000821724787372, -0.500410862393686, 0.064512450702914),
    QPoint2D(-0.677135612512314, -0.677135612512314, 0.050148065233844),
    QPoint2D(-0.677135612512314, 0.354271225024630, 0.050148065233844),
    QPoint2D(0.354271225024630, -0.677135612512314, 0.050148065233844),
    QPoint2D(-0.846803545029258, -0.846803545029258, 0.030543855943664),
    QPoint2D(-0.846803545029258, 0.693607090058514, 0.030543855943664),
    QPoint2D(0.693607090058514, -0.846803545029258, 0.030543855943664),
    QPoint2D(-0.951495121293100, -0.951495121293100, 0.013587844045926),
    QPoint2D(-0.951495121293100, 0.902990242586200, 0.013587844045926),
    QPoint2D(0.902990242586200, -0.951495121293100, 0.013587844045926),
    QPoint2D(-0.913707265566070, -0.913707265566070, -0.004446197459840),
    QPoint2D(-0.913707265566070, 0.827414531132142, -0.004446197459840),
    QPoint2D(0.827414531132142, -0.913707265566070, -0.004446197459840),
    QPoint2D(-0.282177010118112, 0.265315937713272, 0.012663828152812),
    QPoint2D(0.265315937713272, -0.983138927595160, 0.012663828152812),
    QPoint2D(-0.983138927595160, -0.282177010118112, 0.012663828152812),
    QPoint2D(-0.282177010118112, -0.983138927595160, 0.012663828152812),
    QPoint2D(0.265315937713272, -0.282177010118112, 0.012663828152812),
    QPoint2D(-0.983138927595160, 0.265315937713272, 0.012663828152812),
    QPoint2D(-0.411195046496086, 0.148821943021710, 0.054515076098276),
    QPoint2D(0.148821943021710, -0.737626896525624, 0.054515076098276),
    QPoint2D(-0.737626896525624, -0.411195046496086, 0.054515076098276),
    QPoint2D(-0.411195046496086, -0.737626896525624, 0.054515076098276),
    QPoint2D(0.148821943021710, -0.411195046496086, 0.054515076098276),
    QPoint2D(-0.737626896525624, 0.148821943021710, 0.054515076098276),
    QPoint2D(-0.349964396716372, 0.249558093585024, 0.035353571298930),
    QPoint2D(0.249558093585024, -0.899593696868650, 0.035353571298930),
    QPoint2D(-0.899593696868650, -0.349964396716372, 0.035353571298930),
    QPoint2D(-0.349964396716372, -0.899593696868650, 0.035353571298930),
    QPoint2D(0.249558093585024, -0.349964396716372, 0.035353571298930),
    QPoint2D(-0.899593696868650, 0.249558093585024, 0.035353571298930),
    QPoint2D(-0.630524880667908, 0.497866353046074, 0.036758969276140),
    QPoint2D(0.497866353046074, -0.867341472378168, 0.036758969276140),
    QPoint2D(-0.867341472378168, -0.630524880667908, 0.036758969276140),
    QPoint2D(-0.630524880667908, -0.867341472378168, 0.036758969276140),
    QPoint2D(0.497866353046074, -0.630524880667908, 0.036758969276140),
    QPoint2D(-0.867341472378168, 0.497866353046074, 0.036758969276140),
    QPoint2D(-0.562406399973358, 0.538414010840886, 0.016209465616384),
    QPoint2D(0.538414010840886, -0.976007610867528, 0.016209465616384),
    QPoint2D(-0.976007610867528, -0.562406399973358, 0.016209465616384),
    QPoint2D(-0.562406399973358, -0.976007610867528, 0.016209465616384),
    QPoint2D(0.538414010840886, -0.562406399973358, 0.016209465616384),
    QPoint2D(-0.976007610867528, 0.538414010840886, 0.016209465616384),
    QPoint2D(-0.797640805727184, 0.767924604546934, 0.015268258141450),
    QPoint2D(0.767924604546934, -0.970283798819750, 0.015268258141450),
    QPoint2D(-0.970283798819750, -0.797640805727184, 0.015268258141450),
    QPoint2D(-0.797640805727184, -0.970283798819750, 0.015268258141450),
    QPoint2D(0.767924604546934, -0.797640805727184, 0.015268258141450),
    QPoint2D(-0.970283798819750, 0.767924604546934, 0.015268258141450),
    QPoint2D(-0.958250489434828, 1.028694520010726, 0.000092375321588),
    QPoint2D(1.028694520010726, -1.070444030575898, 0.000092375321588),
    QPoint2D(-1.070444030575898, -0.958250489748281, 0.000092375321588),
    QPoint2D(-0.958250489434828, -1.070444030575898, 0.000092375321588),
    QPoint2D(1.028694520010726, -0.958250489434828, 0.000092375321588),
    QPoint2D(-1.070444030575898, 1.028694520010726, 0.000092375321588)
};

static QPoint2D gauss_pts_19_2d_tri[] = {
    QPoint2D(-0.333333333333333, -0.333333333333333, 0.065812662777838),
    QPoint2D(-0.020780025853988, -0.020780025853988, 0.020661463782544),
    QPoint2D(-0.020780025853988, -0.958439948292026, 0.020661463782544),
    QPoint2D(-0.958439948292026, -0.020780025853988, 0.020661463782544),
    QPoint2D(-0.090926214604214, -0.090926214604214, 0.044774494526032),
    QPoint2D(-0.090926214604214, -0.818147570791570, 0.044774494526032),
    QPoint2D(-0.818147570791570, -0.090926214604214, 0.044774494526032),
    QPoint2D(-0.197166638701138, -0.197166638701138, 0.060532251738936),
    QPoint2D(-0.197166638701138, -0.605666722597724, 0.060532251738936),
    QPoint2D(-0.605666722597724, -0.197166638701138, 0.060532251738936),
    QPoint2D(-0.488896691193804, -0.488896691193804, 0.060981935604396),
    QPoint2D(-0.488896691193804, -0.022206617612390, 0.060981935604396),
    QPoint2D(-0.022206617612390, -0.488896691193804, 0.060981935604396),
    QPoint2D(-0.645844115695740, -0.645844115695740, 0.048318425483282),
    QPoint2D(-0.645844115695740, 0.291688231391482, 0.048318425483282),
    QPoint2D(0.291688231391482, -0.645844115695740, 0.048318425483282),
    QPoint2D(-0.779877893544096, -0.779877893544096, 0.032101607173602),
    QPoint2D(-0.779877893544096, 0.559755787088192, 0.032101607173602),
    QPoint2D(0.559755787088192, -0.779877893544096, 0.032101607173602),
    QPoint2D(-0.888942751496320, -0.888942751496320, 0.016169160523568),
    QPoint2D(-0.888942751496320, 0.777885502992642, 0.016169160523568),
    QPoint2D(0.777885502992642, -0.888942751496320, 0.016169160523568),
    QPoint2D(-0.974756272445542, -0.974756272445542, 0.004158724054970),
    QPoint2D(-0.974756272445542, 0.949512544891086, 0.004158724054970),
    QPoint2D(0.949512544891086, -0.974756272445542, 0.004158724054970),
    QPoint2D(-0.208490425286114, 0.201267589589290, 0.007769753809962),
    QPoint2D(0.201267589589290, -0.992777164303176, 0.007769753809962),
    QPoint2D(-0.992777164303176, -0.208490425286114, 0.007769753809962),
    QPoint2D(-0.208490425286114, -0.992777164303176, 0.007769753809962),
    QPoint2D(0.201267589589290, -0.208490425286114, 0.007769753809962),
    QPoint2D(-0.992777164303176, 0.201267589589286, 0.007769753809962),
    QPoint2D(-0.384140032239128, 0.115206523177568, 0.051148321224044),
    QPoint2D(0.115206523177568, -0.731066490938440, 0.051148321224044),
    QPoint2D(-0.731066490938440, -0.384140032239128, 0.051148321224044),
    QPoint2D(-0.384140032239128, -0.731066490938440, 0.051148321224044),
    QPoint2D(0.115206523177568, -0.384140032239128, 0.051148321224044),
    QPoint2D(-0.731066490938440, 0.115206523177568, 0.051148321224044),
    QPoint2D(-0.470866103186960, 0.441974051634730, 0.017761807146676),
    QPoint2D(0.441974051634730, -0.971107948447770, 0.017761807146676),
    QPoint2D(-0.971107948447770, -0.470866103186960, 0.017761807146676),
    QPoint2D(-0.470866103186960, -0.971107948447770, 0.017761807146676),
    QPoint2D(0.441974051634730, -0.470866103186960, 0.017761807146676),
    QPoint2D(-0.971107948447770, 0.441974051634730, 0.017761807146676),
    QPoint2D(-0.282921295588098, 0.189054137911742, 0.032249093523462),
    QPoint2D(0.189054137911742, -0.906132842323644, 0.032249093523462),
    QPoint2D(-0.906132842323644, -0.282921295588098, 0.032249093523462),
    QPoint2D(-0.282921295588098, -0.906132842323644, 0.032249093523462),
    QPoint2D(0.189054137911742, -0.282921295588098, 0.032249093523462),
    QPoint2D(-0.906132842323644, 0.189054137911742, 0.032249093523462),
    QPoint2D(-0.684385188062810, 0.678662947361678, 0.004983883634982),
    QPoint2D(0.678662947361678, -0.994277759298866, 0.004983883634982),
    QPoint2D(-0.994277759298866, -0.684385188062810, 0.004983883634982),
    QPoint2D(-0.684385188062810, -0.994277759298866, 0.004983883634982),
    QPoint2D(0.678662947361678, -0.684385188062810, 0.004983883634982),
    QPoint2D(-0.994277759298866, 0.678662947361678, 0.004983883634982),
    QPoint2D(-0.849898806048178, 0.402175957852346, 0.036485680237902),
    QPoint2D(0.402175957852346, -0.552277151804168, 0.036485680237902),
    QPoint2D(-0.552277151804168, -0.849898806048178, 0.036485680237902),
    QPoint2D(-0.849898806048178, -0.552277151804168, 0.036485680237902),
    QPoint2D(0.402175957852346, -0.849898806048178, 0.036485680237902),
    QPoint2D(-0.552277151804168, 0.402175957852346, 0.036485680237902),
    QPoint2D(-0.715156797773234, 0.645862648139714, 0.020517127472398),
    QPoint2D(0.645862648139714, -0.930705850366480, 0.020517127472398),
    QPoint2D(-0.930705850366480, -0.715156797773234, 0.020517127472398),
    QPoint2D(-0.715156797773234, -0.930705850366480, 0.020517127472398),
    QPoint2D(0.645862648139714, -0.715156797773234, 0.020517127472398),
    QPoint2D(-0.930705850366480, 0.645862648139714, 0.020517127472398),
    QPoint2D(-0.869010743834124, 0.848688505241568, 0.007599857710604),
    QPoint2D(0.848688505241568, -0.979677761407444, 0.007599857710604),
    QPoint2D(-0.979677761407444, -0.869010743834124, 0.007599857710604),
    QPoint2D(-0.869010743834124, -0.979677761407444, 0.007599857710604),
    QPoint2D(0.848688505241568, -0.869010743834124, 0.007599857710604),
    QPoint2D(-0.979677761407444, 0.848688505241568, 0.007599857710604)
};

static QPoint2D gauss_pts_20_2d_tri[] = {
    QPoint2D(-0.333333333333333, -0.333333333333333, 0.066114111083248),
    QPoint2D(0.001900928704400, 0.001900928704400, 0.001734038371326),
    QPoint2D(0.001900928704400, -1.003801857408800, 0.001734038371326),
    QPoint2D(-1.003801857408800, 0.001900928704400, 0.001734038371326),
    QPoint2D(-0.023574084130543, -0.023574084130543, 0.023320105432896),
    QPoint2D(-0.023574084130543, -0.952851831738914, 0.023320105432896),
    QPoint2D(-0.952851831738914, -0.023574084130543, 0.023320105432896),
    QPoint2D(-0.089726626099435, -0.089726626099435, 0.045753872712842),
    QPoint2D(-0.089726626099435, -0.820546727801130, 0.045753872712842),
    QPoint2D(-0.820546727801130, -0.089726626099435, 0.045753872712842),
    QPoint2D(-0.196007481363421, -0.196007481363421, 0.060897965347876),
    QPoint2D(-0.196007481363421, -0.607985037273158, 0.060897965347876),
    QPoint2D(-0.607985037273158, -0.196007481363421, 0.060897965347876),
    QPoint2D(-0.488214180481157, -0.488214180481157, 0.061249783450710),
    QPoint2D(-0.488214180481157, -0.023571639037686, 0.061249783450710),
    QPoint2D(-0.023571639037686, -0.488214180481157, 0.061249783450710),
    QPoint2D(-0.647023488009788, -0.647023488009788, 0.048736115353600),
    QPoint2D(-0.647023488009788, 0.294046976019576, 0.048736115353600),
    QPoint2D(0.294046976019576, -0.647023488009788, 0.048736115353600),
    QPoint2D(-0.791658289326483, -0.791658289326483, 0.031994864064048),
    QPoint2D(-0.791658289326483, 0.583316578652966, 0.031994864064048),
    QPoint2D(0.583316578652966, -0.791658289326483, 0.031994864064048),
    QPoint2D(-0.893862072318140, -0.893862072318140, 0.015396603631204),
    QPoint2D(-0.893862072318140, 0.787724144636280, 0.015396603631204),
    QPoint2D(0.787724144636280, -0.893862072318140, 0.015396603631204),
    QPoint2D(-0.916762569607942, -0.916762569607942, -0.001264120994976),
    QPoint2D(-0.916762569607942, 0.833525139215884, -0.001264120994976),
    QPoint2D(0.833525139215884, -0.916762569607942, -0.001264120994976),
    QPoint2D(-0.976836157186356, -0.976836157186356, 0.003502268602386),
    QPoint2D(-0.976836157186356, 0.953672314372712, 0.003502268602386),
    QPoint2D(0.953672314372712, -0.976836157186356, 0.003502268602386),
    QPoint2D(-0.310288459541998, 0.212805292212320, 0.032931678379152),
    QPoint2D(0.212805292212320, -0.902516832670322, 0.032931678379152),
    QPoint2D(-0.902516832670322, -0.310288459541998, 0.032931678379152),
    QPoint2D(-0.310288459541998, -0.902516832670322, 0.032931678379152),
    QPoint2D(0.212805292212320, -0.310288459541998, 0.032931678379152),
    QPoint2D(-0.902516832670322, 0.212805292212320, 0.032931678379152),
    QPoint2D(-0.244313460810292, 0.231685228913082, 0.009678067080970),
    QPoint2D(0.231685228913082, -0.987371768102790, 0.009678067080970),
    QPoint2D(-0.987371768102790, -0.244313460810292, 0.009678067080970),
    QPoint2D(-0.244313460810292, -0.987371768102790, 0.009678067080970),
    QPoint2D(0.231685228913082, -0.244313460810292, 0.009678067080970),
    QPoint2D(-0.987371768102790, 0.231685228913082, 0.009678067080970),
    QPoint2D(-0.386729041875286, 0.118096000780590, 0.051609813069300),
    QPoint2D(0.118096000780590, -0.731366958905304, 0.051609813069300),
    QPoint2D(-0.731366958905304, -0.386729041875286, 0.051609813069300),
    QPoint2D(-0.386729041875286, -0.731366958905304, 0.051609813069300),
    QPoint2D(0.118096000780590, -0.386729041875286, 0.051609813069300),
    QPoint2D(-0.731366958905304, 0.118096000780590, 0.051609813069300),
    QPoint2D(-0.501161274450516, 0.473213486525732, 0.016942182108882),
    QPoint2D(0.473213486525732, -0.972052212075216, 0.016942182108882),
    QPoint2D(-0.972052212075216, -0.501161274450516, 0.016942182108882),
    QPoint2D(-0.501161274450516, -0.972052212075216, 0.016942182108882),
    QPoint2D(0.473213486525732, -0.501161274450516, 0.016942182108882),
    QPoint2D(-0.972052212075216, 0.473213486525732, 0.016942182108882),
    QPoint2D(-0.574448550394396, 0.423350284574868, 0.036709828212560),
    QPoint2D(0.423350284574868, -0.848901734180472, 0.036709828212560),
    QPoint2D(-0.848901734180472, -0.574448550394396, 0.036709828212560),
    QPoint2D(-0.574448550394396, -0.848901734180472, 0.036709828212560),
    QPoint2D(0.423350284574868, -0.574448550394396, 0.036709828212560),
    QPoint2D(-0.848901734180472, 0.423350284574868, 0.036709828212560),
    QPoint2D(-0.706069127893522, 0.722805434309974, 0.001408809355816),
    QPoint2D(0.722805434309974, -1.016736306416454, 0.001408809355816),
    QPoint2D(-1.016736306416454, -0.706069127893522, 0.001408809355816),
    QPoint2D(-0.706069127893522, -1.016736306416454, 0.001408809355816),
    QPoint2D(0.722805434309974, -0.706069127893522, 0.001408809355816),
    QPoint2D(-1.016736306416454, 0.722805434309974, 0.001408809355816),
    QPoint2D(-0.724546042342154, 0.671173915824726, 0.020225369854924),
    QPoint2D(0.671173915824726, -0.946627873482572, 0.020225369854924),
    QPoint2D(-0.946627873482572, -0.724546042342154, 0.020225369854924),
    QPoint2D(-0.724546042342154, -0.946627873482572, 0.020225369854924),
    QPoint2D(0.671173915824726, -0.724546042342154, 0.020225369854924),
    QPoint2D(-0.946627873482572, 0.671173915824726, 0.020225369854924),
    QPoint2D(-0.880607781701986, 0.859512343113706, 0.007147818771900),
    QPoint2D(0.859512343113706, -0.978904561411718, 0.007147818771900),
    QPoint2D(-0.978904561411718, -0.880607781701986, 0.007147818771900),
    QPoint2D(-0.880607781701986, -0.978904561411718, 0.007147818771900),
    QPoint2D(0.859512343113706, -0.880607781701986, 0.007147818771900),
    QPoint2D(-0.978904561411718, 0.859512343113706, 0.007147818771900)
};

static uint gauss_np_2d_tri[] = {
    sizeof(gauss_pts_0_2d_tri) / sizeof(QPoint2D),  sizeof(gauss_pts_1_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_2_2d_tri) / sizeof(QPoint2D),  sizeof(gauss_pts_3_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_4_2d_tri) / sizeof(QPoint2D),  sizeof(gauss_pts_5_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_6_2d_tri) / sizeof(QPoint2D),  sizeof(gauss_pts_7_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_8_2d_tri) / sizeof(QPoint2D),  sizeof(gauss_pts_9_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_10_2d_tri) / sizeof(QPoint2D), sizeof(gauss_pts_11_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_12_2d_tri) / sizeof(QPoint2D), sizeof(gauss_pts_13_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_14_2d_tri) / sizeof(QPoint2D), sizeof(gauss_pts_15_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_16_2d_tri) / sizeof(QPoint2D), sizeof(gauss_pts_17_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_18_2d_tri) / sizeof(QPoint2D), sizeof(gauss_pts_19_2d_tri) / sizeof(QPoint2D),
    sizeof(gauss_pts_20_2d_tri) / sizeof(QPoint2D)
};

static QPoint2D * gauss_tables_2d_tri[] = {
    gauss_pts_0_2d_tri,  gauss_pts_1_2d_tri,  gauss_pts_2_2d_tri,  gauss_pts_3_2d_tri,
    gauss_pts_4_2d_tri,  gauss_pts_5_2d_tri,  gauss_pts_6_2d_tri,  gauss_pts_7_2d_tri,
    gauss_pts_8_2d_tri,  gauss_pts_9_2d_tri,  gauss_pts_10_2d_tri, gauss_pts_11_2d_tri,
    gauss_pts_12_2d_tri, gauss_pts_13_2d_tri, gauss_pts_14_2d_tri, gauss_pts_15_2d_tri,
    gauss_pts_16_2d_tri, gauss_pts_17_2d_tri, gauss_pts_18_2d_tri, gauss_pts_19_2d_tri,
    gauss_pts_20_2d_tri,
};

static QuadratureGauss2DTri quad_gauss_2d_tri;

QuadratureGauss2DTri::QuadratureGauss2DTri()
{
    _F_;

    this->max_order = MAX_ORDER;
    this->np = gauss_np_2d_tri;
    this->tables = gauss_tables_2d_tri;

    this->edge_tables = new QPoint2D **[Tri::NUM_EDGES];
    MEM_CHECK(this->edge_tables);
    const Point2D * ref_vtcs = RefTri::get_vertices();
    assert(ref_vtcs != NULL);
    QuadratureGauss1D & gauss_1d = QuadratureGauss1D::get();
    for (uint edge = 0; edge < Tri::NUM_EDGES; edge++) {
        const uint * edge_vtcs = RefTri::get_edge_vertices(edge);
        assert(edge_vtcs != NULL);
        this->edge_tables[edge] = new QPoint2D *[MAX_ORDER + 1];
        MEM_CHECK(this->edge_tables[edge]);
        for (uint order = 0; order <= MAX_ORDER; order++) {
            uint num = gauss_1d.get_num_points(order);
            this->edge_tables[edge][order] = new QPoint2D[num];
            MEM_CHECK(this->edge_tables[edge][order]);
            QPoint1D * pts1d = gauss_1d.get_points(order);
            for (uint p = 0; p < num; p++) {
                double t = (pts1d[p].x + 1.0) * 0.5;
                double s = 1.0 - t;
                this->edge_tables[edge][order][p].x =
                    ref_vtcs[edge_vtcs[0]].x * s + ref_vtcs[edge_vtcs[1]].x * t;
                this->edge_tables[edge][order][p].y =
                    ref_vtcs[edge_vtcs[0]].y * s + ref_vtcs[edge_vtcs[1]].y * t;
                this->edge_tables[edge][order][p].w = pts1d[p].w;
            }
        }
    }
}

QuadratureGauss2DTri::~QuadratureGauss2DTri()
{
    _F_;

    for (uint edge = 0; edge < Tri::NUM_EDGES; edge++) {
        for (uint order = 0; order <= MAX_ORDER; order++)
            delete[] this->edge_tables[edge][order];

        delete[] this->edge_tables[edge];
    }

    delete[] edge_tables;
}

QuadratureGauss2DTri &
QuadratureGauss2DTri::get()
{
    return quad_gauss_2d_tri;
}

} // namespace godzilla
